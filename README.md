Ниже приведён обновлённый вариант README.md с более чёткой структурой и подробным содержанием:

---

# Email AI Frontend

Данное приложение представляет фронтенд для работы с Email AI, включающее авторизацию через Google, отображение информации о подписке, работу с таблицей взаимодействий и историю переписки.

---

## Содержание

1. [Авторизация и доступ к аккаунту](#авторизация-и-доступ-к-аккаунту)
2. [Основной экран: Таблица взаимодействий](#основной-экран-таблица-взаимодействий)
3. [История переписки](#история-переписки)
4. [Навигация и маршруты](#навигация-и-маршруты)
5. [Структура проекта](#структура-проекта)
6. [Технологический стек](#технологический-стек)
7. [API-взаимодействие](#api-взаимодействие)
8. [Backend API Endpoints](#backend-api-endpoints)
9. [Запуск приложения](#запуск-приложения)

---

## Авторизация и доступ к аккаунту

### Функциональные возможности

- **SSO авторизация через Gmail**
  - На главной странице отображается кнопка для входа через Google.
  - Авторизация реализована с использованием бэкенда.
  
- **Проверка подписки**
  - После успешной авторизации пользователю отображается текущий статус подписки, который загружается с бэкенда.

### Основные компоненты

- **`LoginPage`**  
  Страница авторизации с кнопкой "Войти через Google".

- **`AccountStatus`**  
  Компонент для отображения статуса подписки пользователя.

---

## Основной экран: Таблица взаимодействий

### Структура таблицы

В таблице взаимодействий отображаются следующие поля:

- **Email пользователя**
- **Name** – имя пользователя.
- **Description** – краткое описание ассистента.
- **Статус** – кнопка для переключения между состояниями (Stop/Active).
- **Удаление** – кнопка для удаления пользователя.

### Компоненты

- **`InteractionTable`**  
  Основной компонент таблицы взаимодействий.

- **`ToggleStatusButton`**  
  Компонент для управления переключением статуса.

- **`DeleteButton`**  
  Компонент для удаления записи (с сохранением истории).

### API-взаимодействие

- **Получение списка пользователей.**
- **Управление статусом взаимодействия.**
- **Удаление пользователя** (при этом история переписки сохраняется).

---

## История переписки

### Функционал

- Просмотр хронологии сообщений.
- Возврат к основной таблице взаимодействий.

### Компоненты

- **`ChatHistoryModal`**  
  Модальное окно, отображающее историю переписки.

- **`CloseButton`**  
  Кнопка для закрытия модального окна и возврата к таблице.

### API-взаимодействие

- Загрузка истории переписки происходит при открытии модального окна.

---

## Навигация и маршруты

Приложение включает следующие маршруты:

- **`/login`**  
  Страница авторизации.

- **`/dashboard`**  
  Основная страница с таблицей взаимодействий.

- **`/dashboard/chat-history/:id`**  
  Страница для просмотра истории переписки по конкретному идентификатору.

---

## Структура проекта

```
src/
├── components/
│   ├── LoginPage.tsx
│   ├── AccountStatus.tsx
│   ├── InteractionTable.tsx
│   ├── ToggleStatusButton.tsx
│   ├── DeleteButton.tsx
│   ├── ChatHistoryModal.tsx
│   └── CloseButton.tsx
├── routes/
│   ├── login.tsx
│   ├── dashboard.tsx
│   └── chat-history.tsx
└── api/
    ├── auth.ts
    ├── interactions.ts
    └── chatHistory.ts
```

---

## Технологический стек

### Основные технологии

- **Remix.run**
  - Современный фреймворк для React-приложений.
  - Преимущества:
    - Улучшенное SEO.
    - Быстрая загрузка страниц.
    - Удобная серверная обработка данных.

- **React**
  - Библиотека для создания UI-компонентов.
  - Базовая платформа для приложения, построенного на Remix.run.

- **TypeScript**
  - Типизированный вариант JavaScript.
  - Преимущества:
    - Повышенная надёжность кода.
    - Улучшенная поддерживаемость.
    - Удобство разработки.

### Стилизация

- **Tailwind CSS**
  - Утилитарный CSS-фреймворк.
  - Гибкая система классов и поддержка адаптивного дизайна.
  
- **CSS Modules (альтернатива)**
  - Изоляция стилей компонентов.
  - Предотвращение конфликтов имён.

---

## API-взаимодействие

### HTTP-клиенты

- **Axios**
  - Популярная библиотека для отправки HTTP-запросов.

- **Remix Fetch API**
  - Встроенный механизм для выполнения запросов в Remix.

### Основные операции API

- Авторизация пользователей.
- Получение данных о пользователях.
- Управление статусами взаимодействий.
- Работа с историей переписки.

### Пример запроса для проверки авторизации

```http
GET /api/auth/check
```

- **Назначение:** Проверка статуса авторизации и получение информации о подписке.

---

## Backend API Endpoints

### Аутентификация (/auth)

#### 1. **GET /auth/google/login**

- **Назначение:** Генерация URL для авторизации через Google OAuth.
- **Возвращает:**  
  ```json
  {
      "authorization_url": "string"
  }
  ```
  *(URL для редиректа на страницу авторизации Google)*  
- **Примечание:** Устанавливает cookie `oauth_state` для безопасности.

#### 2. **GET /auth/google/callback**

- **Назначение:** Обработка callback от Google после успешной авторизации.
- **Принимает:**  
  - `code`: string – код авторизации от Google.
  - `state`: string – токен безопасности.
- **Возвращает:**  
  ```json
  {
      "status": "success",
      "message": "Successfully authenticated",
      "is_new_user": boolean
  }
  ```
- **Примечание:** Устанавливает cookie `access_token` с JWT токеном.

#### 3. **POST /auth/set-password**

- **Назначение:** Добавление пароля к аккаунту, зарегистрированному через OAuth.
- **Принимает:**  
  - `password`: string
- **Требует:** JWT аутентификацию.
- **Возвращает:**  
  ```json
  {
      "status": "success", 
      "message": "Password successfully set"
  }
  ```

#### 4. **GET /auth/check**

- **Назначение:** Проверка валидности текущей сессии и статуса Google токенов.
- **Требует:** JWT аутентификацию.
- **Возвращает:**  
  ```json
  {
      "authenticated": true,
      "user": {
          "id": number,
          "email": string,
          "name": string
      },
      "google_oauth": {
          "connected": boolean,
          "token_status": "valid" | "refreshed" | "invalid" | null
      }
  }
  ```

---

### Ассистенты (/assistants)

#### **POST /assistants/email/gmail**

- **Назначение:** Проверка валидности Gmail токена.
- **Принимает:**  
  - `token`: string – Gmail access token в заголовке Authorization.
- **Возвращает:**  
  ```json
  {
      "status": "success",
      "message": "Gmail токен валиден"
  }
  ```
- **Ошибки:**
  - 401 – невалидный токен.
  - 500 – внутренняя ошибка сервера.

---

### Интеграции

Все эндпоинты интегрированы с:
- **Google OAuth** для аутентификации.
- **JWT** для управления сессиями и автоматического обновления токенов.
- **Базой данных** для хранения учетных данных пользователей.

---

## Запуск приложения

Для локального запуска проекта используйте команду:
```bash
remix dev
```

Это запустит сервер разработки, позволяющий тестировать и отлаживать приложение в режиме реального времени.

---

Эта структура README.md файла предоставляет чёткое разделение на логические блоки, описывает как функциональность фронтенда, так и взаимодействие с бэкендом, а также перечисляет основные технологии и инструкции по запуску проекта.
